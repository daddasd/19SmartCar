C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE SEEKFREE_IMU660RA
OBJECT MODULE PLACED IN .\Out_File\SEEKFREE_IMU660RA.obj
COMPILER INVOKED BY: E:\Keil5C251\C251\BIN\C251.EXE ..\..\Libraries\seekfree_peripheral\SEEKFREE_IMU660RA.c XSMALL WARNI
                    -NGLEVEL(3) OPTIMIZE(0,SPEED) BROWSE INCDIR(..\..\Libraries\libraries;..\..\Libraries\seekfree_libraries;..\..\Libraries\
                    -seekfree_peripheral;..\CODE;..\USER\inc;..\USER\src;..\USER\Hardware;..\USER\Hardware) DEBUG PRINT(.\Out_File\SEEKFREE_I
                    -MU660RA.lst) TABS(2) OBJECT(.\Out_File\SEEKFREE_IMU660RA.obj) 

stmt  level    source

    1          /********************************************************************************************************
             -*************
    2           * COPYRIGHT NOTICE
    3           * Copyright (c) 2018,é€é£ç§‘æŠ€
    4           * All rights reserved.
    5           * æŠ€æœ¯è®¨è®ºQQç¾¤ï¼šä¸€ç¾¤ï¼š179029047(å·²æ»¡)  äºŒç¾¤ï¼š244861897
    6           *
    7           * ä»¥ä¸‹æ‰€æœ‰å†…å®¹ç‰ˆæƒå‡å±é€é£ç§‘æŠ€æ‰€æœ‰ï¼Œæœªç»å…è®¸ä¸å¾—ç”¨äºå•†ä¸šç”¨é€”ï¼Œ
    8           * æ¬¢è¿å„ä½ä½¿ç”¨å¹¶ä¼ æ’­æœ¬ç¨‹åºï¼Œä¿®æ”¹å†…å®¹æ—¶å¿…é¡»ä¿ç•™é€é£ç§‘æŠ€çš„ç‰ˆæƒå£°æ˜ã€‚
    9           *
   10           * @file          IMU660RA
   11           * @company       æˆéƒ½é€é£ç§‘æŠ€æœ‰é™å…¬å¸
   12           * @author        é€é£ç§‘æŠ€(QQ3184284598)
   13           * @version       æŸ¥çœ‹docå†…versionæ–‡ä»¶ ç‰ˆæœ¬è¯´æ˜
   14           * @Software    MDK FOR C251 V5.60
   15           * @Target core   STC32F12K
   16           * @Taobao      https://seekfree.taobao.com/
   17           * @date          2019-04-30
   18           * @note    
   19           * æ¥çº¿å®šä¹‰ï¼š
   20           *                   ------------------------------------
   21           *                   æ¨¡å—ç®¡è„š            å•ç‰‡æœºç®¡è„š
   22           *                   // ç¡¬ä»¶ SPI å¼•è„š
   23           *                   SCL/SPC           æŸ¥çœ‹ SEEKFREE_IMU660RA.h ä¸­ IMU660RA_SPC_PIN å®å®šä¹‰
   24           *                   SDA/DSI           æŸ¥çœ‹ SEEKFREE_IMU660RA.h ä¸­ IMU660RA_SDI_PIN å®å®šä¹‰
   25           *                   SA0/SDO           æŸ¥çœ‹ SEEKFREE_IMU660RA.h ä¸­ IMU660RA_SDO_PIN å®å®šä¹‰
   26           *                   CS                æŸ¥çœ‹ SEEKFREE_IMU660RA.h ä¸­ IMU660RA_CS_PIN å®å®šä¹‰
   27           *                   VCC               3.3Vç”µæº
   28           *                   GND               ç”µæºåœ°
   29           *                   å…¶ä½™å¼•è„šæ‚¬ç©º
   30           *
   31           *                   // è½¯ä»¶ IIC å¼•è„š
   32           *                   SCL/SPC           æŸ¥çœ‹ SEEKFREE_IMU660RA.h ä¸­ IMU660RA_SCL_PIN å®å®šä¹‰
   33           *                   SDA/DSI           æŸ¥çœ‹ SEEKFREE_IMU660RA.h ä¸­ IMU660RA_SDA_PIN å®å®šä¹‰
   34           *                   VCC               3.3Vç”µæº
   35           *                   GND               ç”µæºåœ°
   36           *                   å…¶ä½™å¼•è„šæ‚¬ç©º
   37           *                   ------------------------------------
   38          *********************************************************************************************************
             -***********/
   39          
   40          #include "SEEKFREE_IMU660RA.h"
   41          
   42          #include "SEEKFREE_CONFIG.h"
   43          
   44          #include "zf_delay.h"
   45          #include "zf_spi.h"
   46          
   47          
   48          #pragma warning disable = 177
   49          #pragma warning disable = 183
   50          
   51          
   52          
   53          int16 imu660ra_gyro_x = 0, imu660ra_gyro_y = 0, imu660ra_gyro_z = 0;            // ä¸‰è½´é™€èºä»ªæ•°æ® 
             -  gyro (é™€èºä»ª)
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 2   

   54          int16 imu660ra_acc_x = 0, imu660ra_acc_y = 0, imu660ra_acc_z = 0;               // ä¸‰è½´åŠ é€Ÿåº¦è®¡æ•°æ
             -® acc  (accelerometer åŠ é€Ÿåº¦è®¡)
   55          
   56          #if IMU660RA_USE_SOFT_IIC
   57          
   58          #define GET_IMU660RA_SDA          IMU660RA_SDA_PIN
   59          #define IMU660RA_SCL_LOW()            IMU660RA_SCL_PIN = 0    //IOå£è¾“å‡ºä½ç”µå¹³
   60          #define IMU660RA_SCL_HIGH()           IMU660RA_SCL_PIN = 1    //IOå£è¾“å‡ºé«˜ç”µå¹³
   61          #define IMU660RA_SDA_LOW()            IMU660RA_SDA_PIN = 0    //IOå£è¾“å‡ºä½ç”µå¹³
   62          #define IMU660RA_SDA_HIGH()           IMU660RA_SDA_PIN = 1    //IOå£è¾“å‡ºé«˜ç”µå¹³
   63          
   64          
   65          #define ack 1      //ä¸»åº”ç­”
   66          #define no_ack 0   //ä»åº”ç­”  
   67          
   68          //-------------------------------------------------------------------------------------------------------
             -------------
   69          //  @brief      æ¨¡æ‹ŸIICå»¶æ—¶
   70          //  @return     void            
   71          //  @since      v1.0
   72          //  Sample usage:       å¦‚æœIICé€šè®¯å¤±è´¥å¯ä»¥å°è¯•å¢åŠ jçš„å€¼
   73          //-------------------------------------------------------------------------------------------------------
             -------------
   74          static void imu660ra_simiic_delay(void)
   75          {
   76   1          uint16 j=IMU660RA_SOFT_IIC_DELAY;   
   77   1        while(j--);
   78   1      }
   79          
   80          //å†…éƒ¨ä½¿ç”¨ï¼Œç”¨æˆ·æ— éœ€è°ƒç”¨
   81          static void imu660ra_simiic_start(void)
   82          {
   83   1        IMU660RA_SDA_HIGH();
   84   1        IMU660RA_SCL_HIGH();
   85   1        imu660ra_simiic_delay();
   86   1        IMU660RA_SDA_LOW();
   87   1        imu660ra_simiic_delay();
   88   1        IMU660RA_SCL_LOW();
   89   1      }
   90          
   91          //å†…éƒ¨ä½¿ç”¨ï¼Œç”¨æˆ·æ— éœ€è°ƒç”¨
   92          static void imu660ra_simiic_stop(void)
   93          {
   94   1        IMU660RA_SDA_LOW();
   95   1        IMU660RA_SCL_LOW();
   96   1        imu660ra_simiic_delay();
   97   1        IMU660RA_SCL_HIGH();
   98   1        imu660ra_simiic_delay();
   99   1        IMU660RA_SDA_HIGH();
  100   1        imu660ra_simiic_delay();
  101   1      }
  102          
  103          //ä¸»åº”ç­”(åŒ…å«ack:SDA=0å’Œno_ack:SDA=0)
  104          //å†…éƒ¨ä½¿ç”¨ï¼Œç”¨æˆ·æ— éœ€è°ƒç”¨
  105          static void imu660ra_simiic_sendack(unsigned char ack_dat)
  106          {
  107   1          IMU660RA_SCL_LOW();
  108   1        imu660ra_simiic_delay();
  109   1        if(ack_dat) IMU660RA_SDA_LOW();
  110   1          else      IMU660RA_SDA_HIGH();
  111   1      
  112   1          IMU660RA_SCL_HIGH();
  113   1          imu660ra_simiic_delay();
  114   1          IMU660RA_SCL_LOW();
  115   1          imu660ra_simiic_delay();
  116   1      }
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 3   

  117          
  118          
  119          static int imu660ra_sccb_waitack(void)
  120          {
  121   1          IMU660RA_SCL_LOW();
  122   1      
  123   1        imu660ra_simiic_delay();
  124   1        
  125   1        IMU660RA_SCL_HIGH();
  126   1          imu660ra_simiic_delay();
  127   1        
  128   1          if(GET_IMU660RA_SDA)           //åº”ç­”ä¸ºé«˜ç”µå¹³ï¼Œå¼‚å¸¸ï¼Œé€šä¿¡å¤±è´¥
  129   1          {
  130   2      
  131   2              IMU660RA_SCL_LOW();
  132   2              return 0;
  133   2          }
  134   1      
  135   1          IMU660RA_SCL_LOW();
  136   1        imu660ra_simiic_delay();
  137   1          return 1;
  138   1      }
  139          
  140          //å­—èŠ‚å‘é€ç¨‹åº
  141          //å‘é€c(å¯ä»¥æ˜¯æ•°æ®ä¹Ÿå¯æ˜¯åœ°å€)ï¼Œé€å®Œåæ¥æ”¶ä»åº”ç­”
  142          //ä¸è€ƒè™‘ä»åº”ç­”ä½
  143          //å†…éƒ¨ä½¿ç”¨ï¼Œç”¨æˆ·æ— éœ€è°ƒç”¨
  144          static void imu660ra_send_ch(uint8 c)
  145          {
  146   1        uint8 i = 8;
  147   1          while(i--)
  148   1          {
  149   2              if(c & 0x80)  IMU660RA_SDA_HIGH();//SDA è¾“å‡ºæ•°æ®
  150   2              else      IMU660RA_SDA_LOW();
  151   2              c <<= 1;
  152   2              imu660ra_simiic_delay();
  153   2              IMU660RA_SCL_HIGH();                //SCL æ‹‰é«˜ï¼Œé‡‡é›†ä¿¡å·
  154   2              imu660ra_simiic_delay();
  155   2              IMU660RA_SCL_LOW();                //SCL æ—¶é’Ÿçº¿æ‹‰ä½
  156   2          }
  157   1        imu660ra_sccb_waitack();
  158   1      }
  159          
  160          
  161          //å­—èŠ‚æ¥æ”¶ç¨‹åº
  162          //æ¥æ”¶å™¨ä»¶ä¼ æ¥çš„æ•°æ®ï¼Œæ­¤ç¨‹åºåº”é…åˆ|ä¸»åº”ç­”å‡½æ•°|ä½¿ç”¨
  163          //å†…éƒ¨ä½¿ç”¨ï¼Œç”¨æˆ·æ— éœ€è°ƒç”¨
  164          static uint8 imu660ra_read_ch(uint8 ack_x)
  165          {
  166   1          uint8 i;
  167   1          uint8 c;
  168   1          c=0;
  169   1          IMU660RA_SCL_LOW();
  170   1          imu660ra_simiic_delay();
  171   1          IMU660RA_SDA_HIGH();             
  172   1      
  173   1          for(i=0;i<8;i++)
  174   1          {
  175   2              imu660ra_simiic_delay();
  176   2              IMU660RA_SCL_LOW();         //ç½®æ—¶é’Ÿçº¿ä¸ºä½ï¼Œå‡†å¤‡æ¥æ”¶æ•°æ®ä½
  177   2              imu660ra_simiic_delay();
  178   2              IMU660RA_SCL_HIGH();         //ç½®æ—¶é’Ÿçº¿ä¸ºé«˜ï¼Œä½¿æ•°æ®çº¿ä¸Šæ•°æ®æœ‰æ•ˆ
  179   2              imu660ra_simiic_delay();
  180   2              c<<=1;
  181   2              if(GET_IMU660RA_SDA) 
  182   2              {
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 4   

  183   3                  c+=1;   //è¯»æ•°æ®ä½ï¼Œå°†æ¥æ”¶çš„æ•°æ®å­˜c
  184   3              }
  185   2          }
  186   1      
  187   1        IMU660RA_SCL_LOW();
  188   1        imu660ra_simiic_delay();
  189   1        imu660ra_simiic_sendack(ack_x);
  190   1        
  191   1          return c;
  192   1      }
  193          
  194          
  195          //-------------------------------------------------------------------------------------------------------
             -------------
  196          //  @brief      æ¨¡æ‹ŸIICå†™æ•°æ®åˆ°è®¾å¤‡å¯„å­˜å™¨å‡½æ•°
  197          //  @param      dev_add     è®¾å¤‡åœ°å€(ä½ä¸ƒä½åœ°å€)
  198          //  @param      reg       å¯„å­˜å™¨åœ°å€
  199          //  @param      dat       å†™å…¥çš„æ•°æ®
  200          //  @return     void            
  201          //  @since      v1.0
  202          //  Sample usage:       
  203          //-------------------------------------------------------------------------------------------------------
             -------------
  204          static void imu660ra_simiic_write_reg(uint8 dev_add, uint8 reg, uint8 dat)
  205          {
  206   1        imu660ra_simiic_start();
  207   1          imu660ra_send_ch( (dev_add<<1) | 0x00);   //å‘é€å™¨ä»¶åœ°å€åŠ å†™ä½
  208   1        imu660ra_send_ch( reg );           //å‘é€ä»æœºå¯„å­˜å™¨åœ°å€
  209   1        imu660ra_send_ch( dat );           //å‘é€éœ€è¦å†™å…¥çš„æ•°æ®
  210   1        imu660ra_simiic_stop();
  211   1      }
  212          
  213          //-------------------------------------------------------------------------------------------------------
             -------------
  214          //  @brief      æ¨¡æ‹ŸIICå†™æ•°æ®åˆ°è®¾å¤‡å¯„å­˜å™¨å‡½æ•°
  215          //  @param      dev_add     è®¾å¤‡åœ°å€(ä½ä¸ƒä½åœ°å€)
  216          //  @param      reg       å¯„å­˜å™¨åœ°å€
  217          //  @param      dat       å†™å…¥çš„æ•°æ®
  218          //  @return     void            
  219          //  @since      v1.0
  220          //  Sample usage:       
  221          //-------------------------------------------------------------------------------------------------------
             -------------
  222          static void imu660ra_simiic_write_regs(uint8 dev_add, uint8 reg, uint8 *dat, uint32 len)
  223          {
  224   1        uint16 i = 0;
  225   1        imu660ra_simiic_start();
  226   1          imu660ra_send_ch( (dev_add<<1) | 0x00);   //å‘é€å™¨ä»¶åœ°å€åŠ å†™ä½
  227   1        imu660ra_send_ch( reg );           //å‘é€ä»æœºå¯„å­˜å™¨åœ°å€
  228   1      
  229   1        while(len--)
  230   1        {
  231   2          imu660ra_send_ch( *dat++ );            //å‘é€éœ€è¦å†™å…¥çš„æ•°æ®
  232   2        }
  233   1      
  234   1        
  235   1        imu660ra_simiic_stop();
  236   1      }
  237          //-------------------------------------------------------------------------------------------------------
             -------------
  238          //  @brief      æ¨¡æ‹ŸIICä»è®¾å¤‡å¯„å­˜å™¨è¯»å–æ•°æ®
  239          //  @param      dev_add     è®¾å¤‡åœ°å€(ä½ä¸ƒä½åœ°å€)
  240          //  @param      reg       å¯„å­˜å™¨åœ°å€
  241          //  @param      type      é€‰æ‹©é€šä¿¡æ–¹å¼æ˜¯IIC  è¿˜æ˜¯ SCCB
  242          //  @return     uint8     è¿”å›å¯„å­˜å™¨çš„æ•°æ®      
  243          //  @since      v1.0
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 5   

  244          //  Sample usage:       
  245          //-------------------------------------------------------------------------------------------------------
             -------------
  246          static uint8 imu660ra_simiic_read_reg(uint8 dev_add, uint8 reg)
  247          {
  248   1        uint8 dat;
  249   1        imu660ra_simiic_start();
  250   1          imu660ra_send_ch( (dev_add<<1) | 0x00);  //å‘é€å™¨ä»¶åœ°å€åŠ å†™ä½
  251   1        imu660ra_send_ch( reg );          //å‘é€ä»æœºå¯„å­˜å™¨åœ°å€
  252   1        
  253   1        imu660ra_simiic_start();
  254   1        imu660ra_send_ch( (dev_add<<1) | 0x01);  //å‘é€å™¨ä»¶åœ°å€åŠ è¯»ä½
  255   1        dat = imu660ra_read_ch(no_ack);           //è¯»å–æ•°æ®
  256   1        imu660ra_simiic_stop();
  257   1        
  258   1        return dat;
  259   1      }
  260          
  261          //-------------------------------------------------------------------------------------------------------
             -------------
  262          //  @brief      æ¨¡æ‹ŸIICè¯»å–å¤šå­—èŠ‚æ•°æ®
  263          //  @param      dev_add     è®¾å¤‡åœ°å€(ä½ä¸ƒä½åœ°å€)
  264          //  @param      reg       å¯„å­˜å™¨åœ°å€
  265          //  @param      dat_add     æ•°æ®ä¿å­˜çš„åœ°å€æŒ‡é’ˆ
  266          //  @param      num       è¯»å–å­—èŠ‚æ•°é‡
  267          //  @param      type      é€‰æ‹©é€šä¿¡æ–¹å¼æ˜¯IIC  è¿˜æ˜¯ SCCB
  268          //  @return     uint8     è¿”å›å¯„å­˜å™¨çš„æ•°æ®      
  269          //  @since      v1.0
  270          //  Sample usage:       
  271          //-------------------------------------------------------------------------------------------------------
             -------------
  272          static void imu660ra_simiic_read_regs(uint8 dev_add, uint8 reg, uint8 *dat_add, uint32 num)
  273          {
  274   1        imu660ra_simiic_start();
  275   1          imu660ra_send_ch( (dev_add<<1) | 0x00);  //å‘é€å™¨ä»¶åœ°å€åŠ å†™ä½
  276   1        imu660ra_send_ch( reg );          //å‘é€ä»æœºå¯„å­˜å™¨åœ°å€
  277   1        
  278   1        imu660ra_simiic_start();
  279   1        imu660ra_send_ch( (dev_add<<1) | 0x01);  //å‘é€å™¨ä»¶åœ°å€åŠ è¯»ä½
  280   1          while(--num)
  281   1          {
  282   2              *dat_add = imu660ra_read_ch(ack); //è¯»å–æ•°æ®
  283   2              dat_add++;
  284   2          }
  285   1          *dat_add = imu660ra_read_ch(no_ack); //è¯»å–æ•°æ®
  286   1        imu660ra_simiic_stop();
  287   1      }
  288          
  289          #define imu660ra_write_register(reg, dat)        (imu660ra_simiic_write_reg(IMU660RA_DEV_ADDR, (reg), (da
             -t)))
  290          #define imu660ra_write_registers(reg, dat, len)  (imu660ra_simiic_write_regs(IMU660RA_DEV_ADDR, (reg), (d
             -at), (len)))
  291          #define imu660ra_read_register(reg)              (imu660ra_simiic_read_reg(IMU660RA_DEV_ADDR, (reg)))
  292          #define imu660ra_read_registers(reg, dat, len)   (imu660ra_simiic_read_regs(IMU660RA_DEV_ADDR, (reg), (da
             -t), (len)))
  293          
  294          #else
               
               
               #define IMU660RA_SCK(x)       IMU660RA_SPC_PIN  = x
               #define IMU660RA_MOSI(x)      IMU660RA_SDI_PIN = x
               #define IMU660RA_CS(x)        IMU660RA_CS_PIN  = x
               #define IMU660RA_MISO         IMU660RA_SDO_PIN 
               
               
               //-------------------------------------------------------------------------------------------------------
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 6   

             -------------
               //  @brief      é€šè¿‡SPIå†™ä¸€ä¸ªbyte,åŒæ—¶è¯»å–ä¸€ä¸ªbyte
               //  @param      byte        å‘é€çš„æ•°æ®    
               //  @return     uint8       return è¿”å›statusçŠ¶æ€
               //  @since      v1.0
               //  Sample usage:
               //-------------------------------------------------------------------------------------------------------
             -------------
               static uint8 imu660ra_simspi_wr_byte(uint8 byte)
               {
                   uint8 i;
                 
                   for(i=0; i<8; i++)
                   {
                       IMU660RA_MOSI(byte&0x80);
                       byte <<= 1;
                   IMU660RA_SCK (0);
                   IMU660RA_SCK (0);
                   IMU660RA_SCK (1);
                   IMU660RA_SCK (1);
                   
                   byte |= IMU660RA_MISO; 
                   } 
                   return(byte);                                         
               }
               //-------------------------------------------------------------------------------------------------------
             -------------
               //  @brief      å°†valå†™å…¥cmdå¯¹åº”çš„å¯„å­˜å™¨åœ°å€,åŒæ—¶è¿”å›statuså­—èŠ‚
               //  @param      cmd         å‘½ä»¤å­—
               //  @param      val         å¾…å†™å…¥å¯„å­˜å™¨çš„æ•°å€¼
               //  @since      v1.0
               //  Sample usage:
               //-------------------------------------------------------------------------------------------------------
             -------------
               static void imu660ra_simspi_w_reg_byte(uint8 cmd, uint8 val)
               {
                   cmd |= IMU660RA_SPI_W;
                   imu660ra_simspi_wr_byte(cmd);                       
                   imu660ra_simspi_wr_byte(val);                                                                   
               }
               
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               //  @brief      å°†valå†™å…¥cmdå¯¹åº”çš„å¯„å­˜å™¨åœ°å€
               //  @param      cmd         å‘½ä»¤å­—
               //  @param      val         å¾…å†™å…¥å¯„å­˜å™¨çš„æ•°å€¼
               //  @since      v1.0
               //  Sample usage:
               //-------------------------------------------------------------------------------------------------------
             -------------
               static void imu660ra_simspi_w_reg_bytes(uint8 cmd, uint8 *dat_addr, uint32 len)
               {
                   cmd |= IMU660RA_SPI_W;
                   imu660ra_simspi_wr_byte(cmd);   
                 while(len--)
                 {
                   imu660ra_simspi_wr_byte(*dat_addr++);   
                 }                                                                 
               }
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               //  @brief      è¯»å–cmdæ‰€å¯¹åº”çš„å¯„å­˜å™¨åœ°å€
               //  @param      cmd         å‘½ä»¤å­—
               //  @param      *val        å­˜å‚¨è¯»å–çš„æ•°æ®åœ°å€
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 7   

               //  @since      v1.0
               //  Sample usage:
               //-------------------------------------------------------------------------------------------------------
             -------------
               //static void imu660ra_simspi_r_reg_byte(uint8 cmd, uint8 *val)
               //{
               //    IMU660RA_CS(0);
               //    cmd |= IMU660RA_SPI_R;
               //    imu660ra_simspi_wr_byte(cmd);                                 
               //    *val = imu660ra_simspi_wr_byte(0);                            
               //    IMU660RA_CS(1);                                     
               //}
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               //  @brief      è¯»å–cmdæ‰€å¯¹åº”çš„å¯„å­˜å™¨åœ°å€
               //  @param      cmd         å‘½ä»¤å­—
               //  @param      *val        å­˜å‚¨è¯»å–çš„æ•°æ®åœ°å€
               //  @param      num         è¯»å–çš„æ•°é‡
               //  @since      v1.0
               //  Sample usage:
               //-------------------------------------------------------------------------------------------------------
             -------------
               static void imu660ra_simspi_r_reg_bytes(uint8 cmd, uint8 *val, uint32 num)
               {
                   cmd |= IMU660RA_SPI_R;
                   imu660ra_simspi_wr_byte(cmd);
                 
                 while(num--)
                 {
                   *val++ = imu660ra_simspi_wr_byte(0);
                 }
               }
               
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               // å‡½æ•°ç®€ä»‹     IMU660RA å†™å¯„å­˜å™¨
               // å‚æ•°è¯´æ˜     reg             å¯„å­˜å™¨åœ°å€
               // å‚æ•°è¯´æ˜     dat            æ•°æ®
               // è¿”å›å‚æ•°     void
               // ä½¿ç”¨ç¤ºä¾‹     imu660ra_write_register(IMU660RA_PWR_CONF, 0x00);                   // å…³é—­é«˜çº§çœ
             -ç”µæ¨¡å¼
               // å¤‡æ³¨ä¿¡æ¯     å†…éƒ¨è°ƒç”¨
               //-------------------------------------------------------------------------------------------------------
             -------------
               static void imu660ra_write_register(uint8 reg, uint8 dat)
               {
                   IMU660RA_CS(0);
                   imu660ra_simspi_w_reg_byte(reg | IMU660RA_SPI_W, dat);
                   IMU660RA_CS(1);
               }
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               // å‡½æ•°ç®€ä»‹     IMU660RA å†™æ•°æ®
               // å‚æ•°è¯´æ˜     reg             å¯„å­˜å™¨åœ°å€
               // å‚æ•°è¯´æ˜     dat            æ•°æ®
               // è¿”å›å‚æ•°     void
               // ä½¿ç”¨ç¤ºä¾‹     imu660ra_write_registers(IMU660RA_INIT_dat, imu660ra_config_file, sizeof(imu660ra_con
             -fig_file));
               // å¤‡æ³¨ä¿¡æ¯     å†…éƒ¨è°ƒç”¨
               //-------------------------------------------------------------------------------------------------------
             -------------
               static void imu660ra_write_registers(uint8 reg, const uint8 *dat, uint32 len)
               {
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 8   

                   IMU660RA_CS(0);
               
                   imu660ra_simspi_w_reg_bytes(reg | IMU660RA_SPI_W, dat, len);
                   IMU660RA_CS(1);
               }
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               // å‡½æ•°ç®€ä»‹     IMU660RA è¯»å¯„å­˜å™¨
               // å‚æ•°è¯´æ˜     reg             å¯„å­˜å™¨åœ°å€
               // è¿”å›å‚æ•°     uint8           æ•°æ®
               // ä½¿ç”¨ç¤ºä¾‹     imu660ra_read_register(IMU660RA_CHIP_ID);
               // å¤‡æ³¨ä¿¡æ¯     å†…éƒ¨è°ƒç”¨
               //-------------------------------------------------------------------------------------------------------
             -------------
               static uint8 imu660ra_read_register(uint8 reg)
               {
                   uint8 dat[2];
                   IMU660RA_CS(0);
                   imu660ra_simspi_r_reg_bytes(reg | IMU660RA_SPI_R, dat, 2);
                   IMU660RA_CS(1);
                   return dat[1];
               }
               
               //-------------------------------------------------------------------------------------------------------
             -------------
               // å‡½æ•°ç®€ä»‹     IMU660RA è¯»æ•°æ®
               // å‚æ•°è¯´æ˜     reg             å¯„å­˜å™¨åœ°å€
               // å‚æ•°è¯´æ˜     dat            æ•°æ®ç¼“å†²åŒº
               // å‚æ•°è¯´æ˜     len             æ•°æ®é•¿åº¦
               // è¿”å›å‚æ•°     void
               // ä½¿ç”¨ç¤ºä¾‹     imu660ra_read_registers(IMU660RA_ACC_ADDRESS, dat, 6);
               // å¤‡æ³¨ä¿¡æ¯     å†…éƒ¨è°ƒç”¨
               //-------------------------------------------------------------------------------------------------------
             -------------
               static void imu660ra_read_registers(uint8 reg, uint8 *dat, uint32 len)
               {
                   IMU660RA_CS(0);
                   imu660ra_simspi_r_reg_bytes(reg | IMU660RA_SPI_R, dat, len);
                 IMU660RA_CS(1);
               }
               #endif
  458          
  459          //-------------------------------------------------------------------------------------------------------
             -------------
  460          // å‡½æ•°ç®€ä»‹     IMU660RA è‡ªæ£€
  461          // å‚æ•°è¯´æ˜     void
  462          // è¿”å›å‚æ•°     uint8           1-è‡ªæ£€å¤±è´¥ 0-è‡ªæ£€æˆåŠŸ
  463          // ä½¿ç”¨ç¤ºä¾‹     imu660ra_self_check();
  464          // å¤‡æ³¨ä¿¡æ¯     å†…éƒ¨è°ƒç”¨
  465          //-------------------------------------------------------------------------------------------------------
             -------------
  466          static uint8 imu660ra_self_check (void)
  467          {
  468   1          uint8 dat = 0, return_state = 0;
  469   1          uint16 timeout_count = 0;
  470   1          do
  471   1          {
  472   2              if(timeout_count ++ > IMU660RA_TIMEOUT_COUNT)
  473   2              {
  474   3                  return_state =  1;
  475   3                  break;
  476   3              }
  477   2              dat = imu660ra_read_register(IMU660RA_CHIP_ID);
  478   2              delay_ms(1);
  479   2          }while(0x24 != dat);                                                        // è¯»å–è®¾å¤‡IDæ˜¯å¦ç­
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 9   

             -‰äº0X24ï¼Œå¦‚æœä¸æ˜¯0X24åˆ™è®¤ä¸ºæ²¡æ£€æµ‹åˆ°è®¾å¤‡
  480   1          return return_state;
  481   1      }
  482          
  483          //-------------------------------------------------------------------------------------------------------
             -------------
  484          // å‡½æ•°ç®€ä»‹     è·å– IMU660RA åŠ é€Ÿåº¦è®¡æ•°æ®
  485          // å‚æ•°è¯´æ˜     void
  486          // è¿”å›å‚æ•°     void
  487          // ä½¿ç”¨ç¤ºä¾‹     imu660ra_get_acc();                                             // æ‰§è¡Œè¯¥å‡½æ•°å
             -ï¼Œç›´æ¥æŸ¥çœ‹å¯¹åº”çš„å˜é‡å³å¯
  488          // å¤‡æ³¨ä¿¡æ¯     ä½¿ç”¨ SPI çš„é‡‡é›†æ—¶é—´ä¸º69us
  489          //             ä½¿ç”¨ IIC çš„é‡‡é›†æ—¶é—´ä¸º126us        é‡‡é›†åŠ é€Ÿåº¦è®¡çš„æ—¶é—´ä¸é‡‡é›†é™€èºä»ªçš„
             -æ—¶é—´ä¸€è‡´çš„åŸå› æ˜¯éƒ½åªæ˜¯è¯»å–å¯„å­˜å™¨æ•°æ®
  490          //-------------------------------------------------------------------------------------------------------
             -------------
  491          void imu660ra_get_acc (void)
  492          {
  493   1      #if IMU660RA_USE_SOFT_IIC
  494   1        uint8 dat[6];
  495   1          imu660ra_read_registers(IMU660RA_ACC_ADDRESS, dat, 6);
  496   1          imu660ra_acc_x = (int16)(((uint16)dat[1]<<8 | dat[0]));
  497   1          imu660ra_acc_y = (int16)(((uint16)dat[3]<<8 | dat[2]));
  498   1          imu660ra_acc_z = (int16)(((uint16)dat[5]<<8 | dat[4]));
  499   1      #else
                 // SPIè¯»å–ç¬¬ä¸€ä¸ªåœ°å€ä¸ºç©º
                 uint8 dat[7];
                 imu660ra_read_registers(IMU660RA_ACC_ADDRESS, dat, 7);
                   imu660ra_acc_x = (int16)(((uint16)dat[2]<<8 | dat[1]));
                   imu660ra_acc_y = (int16)(((uint16)dat[4]<<8 | dat[3]));
                   imu660ra_acc_z = (int16)(((uint16)dat[6]<<8 | dat[5]));
               #endif
  507   1      }
  508          //-------------------------------------------------------------------------------------------------------
             -------------
  509          // å‡½æ•°ç®€ä»‹     è·å– IMU660RA é™€èºä»ªæ•°æ®
  510          // å‚æ•°è¯´æ˜     void
  511          // è¿”å›å‚æ•°     void
  512          // ä½¿ç”¨ç¤ºä¾‹     imu660ra_get_gyro();                                            // æ‰§è¡Œè¯¥å‡½æ•°å
             -ï¼Œç›´æ¥æŸ¥çœ‹å¯¹åº”çš„å˜é‡å³å¯
  513          // å¤‡æ³¨ä¿¡æ¯     ä½¿ç”¨ SPI çš„é‡‡é›†æ—¶é—´ä¸º69us
  514          //             ä½¿ç”¨ IIC çš„é‡‡é›†æ—¶é—´ä¸º126us
  515          //-------------------------------------------------------------------------------------------------------
             -------------
  516          void imu660ra_get_gyro (void)
  517          {
  518   1      #if IMU660RA_USE_SOFT_IIC
  519   1          uint8 dat[6];
  520   1          imu660ra_read_registers(IMU660RA_GYRO_ADDRESS, dat, 6);
  521   1          imu660ra_gyro_x = (int16)(((uint16)dat[1]<<8 | dat[0]));
  522   1          imu660ra_gyro_y = (int16)(((uint16)dat[3]<<8 | dat[2]));
  523   1          imu660ra_gyro_z = (int16)(((uint16)dat[5]<<8 | dat[4]));
  524   1      #else
                 // SPIè¯»å–ç¬¬ä¸€ä¸ªåœ°å€ä¸ºç©º
                 uint8 dat[7];
                 imu660ra_read_registers(IMU660RA_GYRO_ADDRESS, dat, 7);
                   imu660ra_gyro_x = (int16)(((uint16)dat[2]<<8 | dat[1]));
                   imu660ra_gyro_y = (int16)(((uint16)dat[4]<<8 | dat[3]));
                   imu660ra_gyro_z = (int16)(((uint16)dat[6]<<8 | dat[5]));
               #endif
  532   1      }
  533          
  534          //-------------------------------------------------------------------------------------------------------
             -------------
  535          // å‡½æ•°ç®€ä»‹     å°† IMU660RA åŠ é€Ÿåº¦è®¡æ•°æ®è½¬æ¢ä¸ºå®é™…ç‰©ç†æ•°æ®
  536          // å‚æ•°è¯´æ˜     gyro_value      ä»»æ„è½´çš„åŠ é€Ÿåº¦è®¡æ•°æ®
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 10  

  537          // è¿”å›å‚æ•°     void
  538          // ä½¿ç”¨ç¤ºä¾‹     float dat = imu660ra_acc_transition(imu660ra_acc_x);           // å•ä½ä¸º g(m/s^2)
  539          // å¤‡æ³¨ä¿¡æ¯
  540          //-------------------------------------------------------------------------------------------------------
             -------------
  541          float imu660ra_acc_transition (int16 acc_value)
  542          {
  543   1          float acc_dat = 0;
  544   1          switch((uint8)IMU660RA_ACC_SAMPLE)
  545   1          {
  546   2              case 0x00: acc_dat = (float)acc_value / 16384; break;                  // 0x00 åŠ é€Ÿåº¦è®¡é‡ç¨‹
             -ä¸º:Â±2g     è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 16384     å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  547   2              case 0x01: acc_dat = (float)acc_value / 8192; break;                   // 0x01 åŠ é€Ÿåº¦è®¡é‡ç¨‹
             -ä¸º:Â±4g     è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 8192      å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  548   2              case 0x02: acc_dat = (float)acc_value / 4096; break;                   // 0x02 åŠ é€Ÿåº¦è®¡é‡ç¨‹
             -ä¸º:Â±8g     è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 4096      å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  549   2              case 0x03: acc_dat = (float)acc_value / 2048; break;                   // 0x03 åŠ é€Ÿåº¦è®¡é‡ç¨‹
             -ä¸º:Â±16g    è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 2048      å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  550   2              default: break;
  551   2          }
  552   1          return acc_dat;
  553   1      }
  554          
  555          //-------------------------------------------------------------------------------------------------------
             -------------
  556          // å‡½æ•°ç®€ä»‹     å°† IMU660RA é™€èºä»ªæ•°æ®è½¬æ¢ä¸ºå®é™…ç‰©ç†æ•°æ®
  557          // å‚æ•°è¯´æ˜     gyro_value      ä»»æ„è½´çš„é™€èºä»ªæ•°æ®
  558          // è¿”å›å‚æ•°     void
  559          // ä½¿ç”¨ç¤ºä¾‹     float dat = imu660ra_gyro_transition(imu660ra_gyro_x);         // å•ä½ä¸ºÂ°/s
  560          // å¤‡æ³¨ä¿¡æ¯
  561          //-------------------------------------------------------------------------------------------------------
             -------------
  562          float imu660ra_gyro_transition (int16 gyro_value)
  563          {
  564   1          float gyro_dat = 0;
  565   1          switch(IMU660RA_GYR_SAMPLE)
  566   1          {
  567   2              case 0x00: gyro_dat = (float)gyro_value / 16.4f;  break;               //  0x00 é™€èºä»ªé‡ç¨‹ä¸
             -º:Â±2000dps    è·å–åˆ°çš„é™€èºä»ªæ•°æ®é™¤ä»¥ 16.4    å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  568   2              case 0x01: gyro_dat = (float)gyro_value / 32.8f;  break;               //  0x01 é™€èºä»ªé‡ç¨‹ä¸
             -º:Â±1000dps    è·å–åˆ°çš„é™€èºä»ªæ•°æ®é™¤ä»¥ 32.8    å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  569   2              case 0x02: gyro_dat = (float)gyro_value / 65.6f;  break;               //  0x02 é™€èºä»ªé‡ç¨‹ä¸
             -º:Â±500 dps    è·å–åˆ°çš„é™€èºä»ªæ•°æ®é™¤ä»¥ 65.6    å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  570   2              case 0x03: gyro_dat = (float)gyro_value / 131.2f; break;               //  0x03 é™€èºä»ªé‡ç¨‹ä¸
             -º:Â±250 dps    è·å–åˆ°çš„é™€èºä»ªæ•°æ®é™¤ä»¥ 131.2   å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  571   2              case 0x04: gyro_dat = (float)gyro_value / 262.4f; break;               //  0x04 é™€èºä»ªé‡ç¨‹ä¸
             -º:Â±125 dps    è·å–åˆ°çš„é™€èºä»ªæ•°æ®é™¤ä»¥ 262.4   å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  572   2              default: break;
  573   2          }
  574   1          return gyro_dat;
  575   1      }
  576          
  577          //-------------------------------------------------------------------------------------------------------
             -------------
  578          // å‡½æ•°ç®€ä»‹     åˆå§‹åŒ– IMU660RA
  579          // å‚æ•°è¯´æ˜     void
  580          // è¿”å›å‚æ•°     uint8           1-åˆå§‹åŒ–å¤±è´¥ 0-åˆå§‹åŒ–æˆåŠŸ
  581          // ä½¿ç”¨ç¤ºä¾‹     imu660ra_init();
  582          // å¤‡æ³¨ä¿¡æ¯
  583          //-------------------------------------------------------------------------------------------------------
             -------------
  584          uint8 imu660ra_init (void)
  585          {
  586   1          uint8 return_state = 0;
  587   1        
  588   1          delay_ms(20);                                                           // ç­‰å¾…è®¾å¤‡ä¸Šç”µæˆåŠŸ
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 11  

  589   1      
  590   1      //#if IMU660RA_USE_SOFT_IIC 
  591   1      
  592   1      //#else
  593   1      //  imu660ra_read_register(IMU660RA_CHIP_ID);                                   // è¯»å–ä¸€ä¸‹è®¾å¤‡ID å°
             -†è®¾å¤‡è®¾ç½®ä¸ºSPIæ¨¡å¼
  594   1      //  imu660ra_read_register(IMU660RA_CHIP_ID);                                   // è¯»å–ä¸€ä¸‹è®¾å¤‡ID å°
             -†è®¾å¤‡è®¾ç½®ä¸ºSPIæ¨¡å¼
  595   1      //  imu660ra_read_register(IMU660RA_CHIP_ID);                                   // è¯»å–ä¸€ä¸‹è®¾å¤‡ID å°
             -†è®¾å¤‡è®¾ç½®ä¸ºSPIæ¨¡å¼
  596   1      
  597   1      //#endif
  598   1        
  599   1          do{
  600   2              if(imu660ra_self_check())                                               // IMU660RA è‡ªæ£€
  601   2              {
  602   3                  // å¦‚æœç¨‹åºåœ¨è¾“å‡ºäº†æ–­è¨€ä¿¡æ¯ å¹¶ä¸”æç¤ºå‡ºé”™ä½ç½®åœ¨è¿™é‡Œ
  603   3                  // é‚£ä¹ˆå°±æ˜¯ IMU660RA è‡ªæ£€å‡ºé”™å¹¶è¶…æ—¶é€€å‡ºäº†
  604   3                  // æ£€æŸ¥ä¸€ä¸‹æ¥çº¿æœ‰æ²¡æœ‰é—®é¢˜ å¦‚æœæ²¡é—®é¢˜å¯èƒ½å°±æ˜¯åäº†
  605   3            while(1)
  606   3            {
  607   4              printf("imu660ra self check error.\r\n");
  608   4              delay_ms(200);
  609   4            };
  610   3                  return_state = 1;
  611   3                  //break;
  612   3              }
  613   2      
  614   2              imu660ra_write_register(IMU660RA_PWR_CONF, 0x00);                       // å…³é—­é«˜çº§çœç”µæ¨¡å
             -¼
  615   2              delay_ms(10);
  616   2              imu660ra_write_register(IMU660RA_INIT_CTRL, 0x00);                      // å¼€å§‹å¯¹æ¨¡å—è¿›è¡Œå
             -ˆå§‹åŒ–é…ç½®
  617   2              imu660ra_write_registers(IMU660RA_INIT_DATA, imu660ra_config_file, sizeof(imu660ra_config_file));
             -   // è¾“å‡ºé…ç½®æ–‡ä»¶
  618   2              imu660ra_write_register(IMU660RA_INIT_CTRL, 0x01);                      // åˆå§‹åŒ–é…ç½®ç»“æŸ
  619   2              delay_ms(20);
  620   2              if(imu660ra_read_register(IMU660RA_INT_STA) != 1)                       // æ£€æŸ¥æ˜¯å¦é…ç½®å®Œæ
             -ˆ
  621   2              {
  622   3                  // å¦‚æœç¨‹åºåœ¨è¾“å‡ºäº†æ–­è¨€ä¿¡æ¯ å¹¶ä¸”æç¤ºå‡ºé”™ä½ç½®åœ¨è¿™é‡Œ
  623   3                  // é‚£ä¹ˆå°±æ˜¯ IMU660RA é…ç½®åˆå§‹åŒ–æ–‡ä»¶å‡ºé”™äº†
  624   3                  // æ£€æŸ¥IMU660RAåˆå§‹åŒ–ä¹‹å‰ï¼Œæ˜¯å¦æ‰“å¼€äº†å®šæ—¶å™¨ä¸­æ–­ï¼Œåœ¨å®šæ—¶å™¨ä¸­æ–­é‡Œé¢é
             -‡‡é›†äº†660RAçš„æ•°æ®
  625   3      //      while(1)
  626   3      //      {
  627   3              printf("imu660ra init error.\r\n");
  628   3      //        delay_ms(200);
  629   3      //      }
  630   3                  return_state = 1;
  631   3                  //break;
  632   3              }
  633   2              imu660ra_write_register(IMU660RA_PWR_CTRL, 0x0E);                       // å¼€å¯æ€§èƒ½æ¨¡å¼  ä½
             -¿èƒ½é™€èºä»ªã€åŠ é€Ÿåº¦ã€æ¸©åº¦ä¼ æ„Ÿå™¨
  634   2              imu660ra_write_register(IMU660RA_ACC_CONF, 0xA7);                       // åŠ é€Ÿåº¦é‡‡é›†é…ç½® 
             -æ€§èƒ½æ¨¡å¼ æ­£å¸¸é‡‡é›† 50Hz  é‡‡æ ·é¢‘ç‡
  635   2              imu660ra_write_register(IMU660RA_GYR_CONF, 0xA9);                       // é™€èºä»ªé‡‡é›†é…ç½® 
             -æ€§èƒ½æ¨¡å¼ æ­£å¸¸é‡‡é›† 200Hz é‡‡æ ·é¢‘ç‡
  636   2          
  637   2              imu660ra_write_register(IMU660RA_ACC_RANGE, IMU660RA_ACC_SAMPLE);       // åŠ é€Ÿåº¦é‡ç¨‹é…ç½® 
             -é…ç½®é‡ç¨‹ä¸º:Â±8g
  638   2          // IMU660RA_ACC_SAMPLE å¯„å­˜å™¨
  639   2              // è®¾ç½®ä¸º:0x00 é™€èºä»ªé‡ç¨‹ä¸º:Â±2000dps     è·å–åˆ°çš„é™€èºä»ªæ•°æ® é™¤ä»¥ 16.4       
             -å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  640   2              // è®¾ç½®ä¸º:0x01 é™€èºä»ªé‡ç¨‹ä¸º:Â±1000dps     è·å–åˆ°çš„é™€èºä»ªæ•°æ® é™¤ä»¥ 32.8       
             -å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
C251 COMPILER V5.60.0,  SEEKFREE_IMU660RA                                                  27/05/24  21:00:09  PAGE 12  

  641   2              // è®¾ç½®ä¸º:0x02 é™€èºä»ªé‡ç¨‹ä¸º:Â±500 dps     è·å–åˆ°çš„é™€èºä»ªæ•°æ® é™¤ä»¥ 65.6       
             -å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  642   2              // è®¾ç½®ä¸º:0x03 é™€èºä»ªé‡ç¨‹ä¸º:Â±250 dps     è·å–åˆ°çš„é™€èºä»ªæ•°æ® é™¤ä»¥ 131.2      
             -å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  643   2              // è®¾ç½®ä¸º:0x04 é™€èºä»ªé‡ç¨‹ä¸º:Â±125 dps     è·å–åˆ°çš„é™€èºä»ªæ•°æ® é™¤ä»¥ 262.4      
             -å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ä¸ºï¼šÂ°/s
  644   2          
  645   2              imu660ra_write_register(IMU660RA_GYR_RANGE, IMU660RA_GYR_SAMPLE);       // é™€èºä»ªé‡ç¨‹é…ç½® 
             -é…ç½®é‡ç¨‹ä¸º:Â±2000dps
  646   2              // IMU660RA_GYR_RANGE å¯„å­˜å™¨
  647   2              // è®¾ç½®ä¸º:0x00 åŠ é€Ÿåº¦è®¡é‡ç¨‹ä¸º:Â±2g         è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 16384 
             -  å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  648   2              // è®¾ç½®ä¸º:0x01 åŠ é€Ÿåº¦è®¡é‡ç¨‹ä¸º:Â±4g         è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 8192  
             -  å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  649   2              // è®¾ç½®ä¸º:0x02 åŠ é€Ÿåº¦è®¡é‡ç¨‹ä¸º:Â±8g         è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 4096  
             -  å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  650   2              // è®¾ç½®ä¸º:0x03 åŠ é€Ÿåº¦è®¡é‡ç¨‹ä¸º:Â±16g        è·å–åˆ°çš„åŠ é€Ÿåº¦è®¡æ•°æ® é™¤ä»¥ 2048  
             -  å¯ä»¥è½¬åŒ–ä¸ºå¸¦ç‰©ç†å•ä½çš„æ•°æ® å•ä½ï¼šg(m/s^2)
  651   2          
  652   2      
  653   2        
  654   2        }while(0);
  655   1        
  656   1      
  657   1        
  658   1          return return_state;
  659   1      }
  660          
  661          
  662          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =      1354     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =        77     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =        88     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
